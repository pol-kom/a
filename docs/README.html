<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">
<body>
<a href="https://github.com/k1729p/Study13/tree/main/docs"><img alt="" src="images/ColorScheme.png" height="25" width="800"/></a>
<h2 id="contents">Study13 README Contents</h2>

<h3 id="top">Research the JBoss <a href="https://www.wildfly.org/">WildFly</a> application with EJB, JPA, JMS, CMT, BMT</h3>

<p><img alt="" src="images/MermaidFlowchart.png" height="160" width="340"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>The flowchart with the WildFly application.</i></p>

<p>
The sections of this project:
</p>
<ol>
<li><a href="#wildfly">WildFly Application Deploy</A>
<li><a href="#e_j_b">Enterprise JavaBeans</A>
<ul>
<li><a href="#e_j_b_tasks">EJB Example 'Tasks'</A></li>
<li><a href="#e_j_b_checks">EJB Example 'Checks'</A></li>
<li><a href="#e_j_b_interceptor">EJB Example 'Interceptor'</A></li>
</ul></li>
<li><a href="#j_p_a">Java Persistence API</A>
<ul>
<li><a href="#j_p_a_boxes">JPA Example 'Boxes'</a>
(<i>one-to-one</i>, <i>one-to-many</i>, <i>many-to-one</i>, and <i>many-to-many</i> relationships)</li>
<li><a href="#j_p_a_units">JPA Example 'Units'</a>
(<i>previous-next</i> and <i>parent-child</i> self-referential relationships)</li>
<li><a href="#j_p_a_levels">JPA Example 'Levels'</a>(hierarchical multilevel relationships)</li>
</ul></li>
<li><a href="#j_m_s">Java Message Service</A>
<ul>
<li><a href="#j_m_s_sync">JMS Example 'Synchronous Queue &amp; Topic'</A></li>
<li><a href="#j_m_s_async">JMS Example 'Asynchronous Queue &amp; Topic'</A></li>
<li><a href="#j_m_s_other_scenarios">Other JMS test scenarios</A></li>
</ul></li>
<li><a href="#trans_c_m_t">Container-Managed Transactions</A></li>
<li><a href="#trans_b_m_t">Bean-Managed Transactions</A></li>
</ol>

<p>Java source code. Packages in modules 'common', 'ejb':<br>
<img alt="" src="images/aquaHR-500.png"><br>
<img alt="" src="images/aquaSquare.png"> module 'common' application sources: 
<a href="https://github.com/k1729p/Study13/tree/master/common/src/main/java/kp/">kp</a><br>
<img alt="" src="images/aquaSquare.png"> module 'ejb' application sources: 
<a href="https://github.com/k1729p/Study13/tree/master/ejb/src/main/java/kp/">kp</a><br>
<img alt="" src="images/aquaHR-500.png"></p>

<p>
<img alt="" src="images/yellowHR-500.png"><br>
<img alt="" src="images/yellowSquare.png">
    <a href="http://htmlpreview.github.io/?https://github.com/k1729p/Study13/blob/main/docs/apidocs/index.html">
	Java API Documentation</a><br>
<img alt="" src="images/yellowHR-500.png">
</p>

<hr>
<h2 id="wildfly">❶ WildFly Application Deploy</h2>

<p>Action:<br>
<img alt="" src="images/orangeHR-500.png"><br>
<img alt="" src="images/orangeSquare.png"> 1. With batch file 
<a href="https://github.com/k1729p/Study13/blob/main/0_batch/01%20WildFly%20DeleteLog%20Startup.bat"> 
<i>"01 WildFly DeleteLog Startup.bat"</i></a> start the WildFly server.<br>
<img alt="" src="images/orangeSquare.png"> 2. With batch file 
<a href="https://github.com/k1729p/Study13/blob/main/0_batch/02%20MVN%20clean%20install%20deploy%20WildFly.bat"> 
<i>"02 MVN clean install deploy WildFly.bat"</i></a> build and deploy the application<br>
<img alt="" src="images/orangeSquare.png"><img alt="" src="images/spacer-32.png">on the WildFly server.<br>
<img alt="" src="images/orangeSquare.png"> 3. With the URL <a href="http://localhost:8080/Study13/">http://localhost:8080/Study13/</a> 
open in the web browser the '<i>home page</i>'.<br>
<img alt="" src="images/orangeHR-500.png"></p>

<p><img alt="" src="images/greenCircle.png"> 
1.1. The '<i>home page</i>' file <b>index.html</b>: 
<a href="https://github.com/k1729p/Study13/blob/main/web/src/main/webapp/index.html">HTML code</a>, 
<a href="http://htmlpreview.github.io/?https://github.com/k1729p/Study13/blob/main/web/src/main/webapp/index.html">
HTML preview</a>
</p>
<p>
<img alt="" src="images/ScreenshotHomePage.png" height="230" width="365"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>The screenshot of the home page.</i>
</p>

<p><img alt="" src="images/greenCircle.png"> 
1.2. The link to the WildFly Application Server <a href="http://localhost:8080/console">Administration Console</a>.
</p>

<a href="#top">Back to the top of the page</a>
<hr>
<h2 id="e_j_b">❷ Enterprise JavaBeans</h2>

<p>Action:<br>
<img alt="" src="images/orangeHR-500.png"><br>
<img alt="" src="images/orangeSquare.png"> Go to page <a href="http://localhost:8080/Study13/">http://localhost:8080/Study13/</a> 
	and select "Enterprise JavaBeans".<br>
<img alt="" src="images/orangeHR-500.png"></p>

<p><img alt="" src="images/e_j_b_Controls.png" width="1200" /><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from "Enterprise JavaBeans" page controls.</i></p>

<p>
The JSF page on the screenshot 
<a href="https://github.com/k1729p/Study13/blob/main/web/src/main/webapp/e_j_b.xhtml">'e_j_b.xhtml'</a> uses the beans:
</p>
<ul>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/controller/TasksManagedBean.java">
TasksManagedBean</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/controller/ChecksManagedBean.java">
ChecksManagedBean</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/controller/InterceptorsManagedBean.java">
InterceptorsManagedBean</a></li>
</ul>

<a href="#top">Back to the top of the page</a>
<h3 id="e_j_b_tasks"><img alt="" src="images/greenCircle.png"> 
2.1. EJB Example 'Tasks'</h3>
<p>There are three batches (each having five tasks) launched with managed executor service:
<ol>
  <li>The button 'Tasks With Stateless' starts the tasks with the stateless session beans.</li>
  <li>The button 'Tasks With Singleton' starts the tasks with the singleton session beans.</li>
  <li>The button 'Tasks With Stateful' starts the tasks with the stateful session beans.</li>
</ol>

<p><img alt="" src="images/greenCircle.png"> 
2.1.1. The tasks with the <b>stateless</b> session bean 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/remote/StaLeBean.java">StaLeBean</a>.
This is the implementation of the interface 
<a href="https://github.com/k1729p/Study13/blob/main/common/src/main/java/kp/e_j_b/remote/StaLe.java">StaLe</a>.<br>
The method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/controller/TasksManagedBean.java#L90">
TasksManagedBean::researchStateless</a> submits the tasks to the 'ManagedExecutorService'.<br>
It is executed the method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/CommonImpl.java#L47">CommonImpl::change</a>.<br>
</p>

<p>Action:<br>
<img alt="" src="images/orangeHR-500.png"><br>
<img alt="" src="images/orangeSquare.png"> Push the button "Tasks With Stateless" three times.<br>
<img alt="" src="images/orangeHR-500.png"></p>

<p>Results:</p>
<ol>
  <li>It is evident that the bean stateless state (the value of the bean field) as a rule is not preserved.</li>
  <li>All five stateless beans (injected with @EJB) reference the same <b>proxy</b> object (hash codes are equal).</li>
  <li>All five stateless bean instances, used in launched tasks, were different objects (hash codes are not equal).</li>
</ol>

<p><img alt="" src="images/TasksWithStateless.png" height="564" width="1014"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screen from three 'Tasks With Stateless' actions.</i></p>

<p><img alt="" src="images/greenCircle.png"> 
2.1.2. The tasks with the <b>singleton</b> session bean 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/remote/SingBean.java">SingBean</a>. 
This is the implementation of the interface 
<a href="https://github.com/k1729p/Study13/blob/main/common/src/main/java/kp/e_j_b/remote/Sing.java">Sing</a>.<br>
The method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/controller/TasksManagedBean.java#L107">
TasksManagedBean::researchSingleton</a> submits the tasks to the 'ManagedExecutorService'.<br>
It is executed the method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/CommonImpl.java#L47">CommonImpl::change</a>.<br>
</p>

<p>Action:<br>
<img alt="" src="images/orangeHR-500.png"><br>
<img alt="" src="images/orangeSquare.png"> Push the button "Tasks With Singleton" three times.<br>
<img alt="" src="images/orangeHR-500.png"></p>

<p>Results:</p>
<ol>
  <li>From the bean hash code, it is evident that the singleton bean state (the value of the bean field) is always overwritten.</li>
  <li>All five singleton beans (injected with @EJB) reference the same <b>proxy</b> object (hash codes are equal).</li>
  <li>All five singleton bean instances, used in launched tasks, were the same object (hash codes are equal).</li>
</ol>

<p><img alt="" src="images/TasksWithSingleton.png" height="565" width="1056"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from three 'Tasks With Singleton' actions.</i></p>

<p><img alt="" src="images/greenCircle.png"> 
2.1.3. The tasks with the <b>stateful</b> session bean 
<a href="https://github.com/k1729p/Study13/blob/main/common/src/main/java/kp/e_j_b/remote/StaFu.java">StaFu</a>. 
This is the implementation of the interface 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/remote/StaFuBean.java">StaFuBean</a>.<br>
The method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/controller/TasksManagedBean.java#L124">
TasksManagedBean::researchStateful</a> submits the tasks to the 'ManagedExecutorService'.<br>
It is executed the method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/CommonImpl.java#L47">CommonImpl::change</a>.<br>
</p>

<p>Action:<br>
<img alt="" src="images/orangeHR-500.png"><br>
<img alt="" src="images/orangeSquare.png"> Push the button "Tasks With Stateful" three times.<br>
<img alt="" src="images/orangeHR-500.png"></p>

<p>Results:</p>
<ol>
  <li>The bean state (the value of the bean field) is always preserved.</li>
  <li>All five stateful beans (injected with @EJB) reference different <b>proxy</b> objects (hash codes are not equal).</li>
  <li>All five stateful bean instances, used in launched tasks, were different objects (hash codes are not equal).</li>
</ol>

<p><img alt="" src="images/TasksWithStateful.png" height="563" width="1022"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from three 'Tasks With Stateful' actions.</i></p>

<a href="#top">Back to the top of the page</a>
<h3 id="e_j_b_checks"><img alt="" src="images/greenCircle.png"> 
2.2. EJB Example 'Checks'</h3>

<p>Action:<br>
<img alt="" src="images/orangeHR-500.png"><br>
<img alt="" src="images/orangeSquare.png"> Push the button "Check Stateless &amp; Stateful &amp; Singleton".<br>
<img alt="" src="images/orangeHR-500.png"></p>

<p><img alt="" src="images/greenCircle.png"> 
2.2.1. It is executed the method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/controller/ChecksManagedBean.java#L100">
'ChecksManagedBean::researchStatelessStatefulSingleton'</a>.
</p>

<p><img alt="" src="images/greenCircle.png"> 
2.2.2. The bean instances invoked in this example:
</p>
<ol>
<li>Local, no-interface view enterprise bean; injected with '@EJB' annotation; with class name 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/local/NoIntViBean.java">'NoIntViBean'</a>.</li>
<li>Local, stateless enterprise bean; injected with '@EJB' annotation; with class name 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/local/StaLeLocalBean.java">'StaLeLocalBean'</a>.</li>
<li>Remote, stateless enterprise bean; injected with '@EJB' annotation; with class name 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/remote/StaLeBean.java">'StaLeBean'</a>.</li>
<li>Remote, stateful enterprise bean; injected with '@EJB' annotation; with class name 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/remote/StaFuBean.java">'StaFuBean'</a>.</li>
<li>Remote, singleton enterprise bean; injected with '@EJB' annotation; with class name 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/remote/SingBean.java">'SingBean'</a>.</li>
<li>Local, no-interface view enterprise bean; injected with '@Inject' annotation; with class name 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/local/NoIntViBean.java">'NoIntViBean'</a>.</li>
<li>Local, stateless enterprise bean; injected with '@Inject' annotation; with class name 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/local/StaLeLocalBean.java">'StaLeLocalBean'</a>.</li>
</ol>

<p><img alt="" src="images/CheckStatelessStatefulSingleton.png" height="334" width="977"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from 'Check Stateless &amp; Stateful &amp; Singleton' action.</i></p>

<a href="#top">Back to the top of the page</a>
<h3 id="e_j_b_interceptor"><img alt="" src="images/greenCircle.png"> 
2.3. EJB Example 'Interceptor'</h3>

<p>Action:<br>
<img alt="" src="images/orangeHR-500.png"><br>
<img alt="" src="images/orangeSquare.png"> Push the button "Interceptor".<br>
<img alt="" src="images/orangeHR-500.png"></p>

<p><img alt="" src="images/greenCircle.png"> 
2.3.1. There were implemented interceptors for the time elapsed capture.<br>
In the <a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/interceptors/TimeElapsedBean.java">
'TimeElapsedBean'</a> the interceptors were added to those methods:
</p>
<ol>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/interceptors/TimeElapsedBean.java#L51">
'TimeElapsedBean::pausedMilli'</a> - this method stops for one millisecond.</li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/interceptors/TimeElapsedBean.java#L38">
'TimeElapsedBean::pausedNano'</a> - this method stops for one nanosecond.</li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/interceptors/TimeElapsedBean.java#L27">
'TimeElapsedBean::notPaused'</a> - this method is empty inside (has empty body).</li>
</ol>

<p><img alt="" src="images/greenCircle.png"> 
2.3.2. It is executed the method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/e_j_b/controller/InterceptorsManagedBean.java#L39">
'InterceptorsManagedBean::researchInterceptor'</a>.
</p>

<p><img alt="" src="images/Interceptor.png" height="79" width="552"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from 'Interceptor' action.</i></p>

<a href="#top">Back to the top of the page</a>
<hr>
<h2 id="j_p_a">❸ Java Persistence API</h2>
<p>
The data source 'Study13DS' uses an <b>H2 database</b> with the name 'study13' and in-memory mode.<br>
The configuration files:
</p>
<ul>
<li><a href="https://github.com/k1729p/Study13/blob/main/web/src/main/webapp/WEB-INF/study03-ds.xml">'study03-ds.xml'</a> in the 'web' module</li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/resources/META-INF/persistence.xml">'persistence.xml'</a> in the 'ejb' module</li>
</ul>
For CRUD actions there were used the criteria queries. There is a switch in the code to use the named queries.

<p>Action:<br>
<img alt="" src="images/orangeHR-500.png"><br>
<img alt="" src="images/orangeSquare.png"> Go to page <a href="http://localhost:8080/Study13/">http://localhost:8080/Study13/</a>
	and select "Java Persistence API".<br>
<img alt="" src="images/orangeHR-500.png"></p>

<p><img alt="" src="images/j_p_a_Controls.png" width="1200" /><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from "Java Persistence API" page controls.</i></p>

<p>
The JSF page on the screenshot 
<a href="https://github.com/k1729p/Study13/blob/main/web/src/main/webapp/j_p_a.xhtml">'j_p_a.xhtml'</a> uses the beans:
</p>
<ul>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/controller/BoxBean.java">'BoxBean'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/controller/UnitManagedBean.java">'UnitManagedBean'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/controller/LevelManagedBean.java">'LevelManagedBean'</a></li>
</ul>

<a href="#top">Back to the top of the page</a>
<h3 id="j_p_a_boxes"><img alt="" src="images/greenCircle.png"> 
3.1. JPA Example 'Boxes'</h3>

<p>Action:<br>
<img alt="" src="images/orangeHR-500.png"><br>
<img alt="" src="images/orangeSquare.png"> 1. Push the button 'Create Box' four times.<br>
<img alt="" src="images/orangeSquare.png"> 2. Push the button 'Read Boxes'.<br>
<img alt="" src="images/orangeSquare.png"> 3. Push the button 'Update & Read Boxes'.<br>
<img alt="" src="images/orangeSquare.png"> 4. Push the button 'Delete Box' four times.<br>
<img alt="" src="images/orangeHR-500.png"></p>

<p><img alt="" src="images/greenCircle.png"> 
3.1.1. The entity classes for boxes:
</p>
<ul>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/boxes/Box.java">'Box'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/boxes/CentralBox.java">'CentralBox'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/boxes/UpperBox.java">'UpperBox'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/boxes/LowerBox.java">'LowerBox'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/boxes/SingleBox.java">'SingleBox'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/boxes/MultiBox.java">'MultiBox'</a></li>
</ul>

<p><img alt="" src="images/DiagramBoxes.png" height="502" width="750"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>The relationships diagram for the boxes entity classes.</i></p>

<p><img alt="" src="images/greenCircle.png"> 
3.1.2. For the 'Create Box' (method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/controller/BoxBean.java#L91">'BoxBean::createCentralBox'</a>
) only the first 3 calls were successful.<br>
The 4th call failed because the allowable creation maximum is 3 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/boxes/CentralBox.java">'CentralBox'</a> objects.<br>
It was the transaction rollback on the 4th call.
</p>

<p><img alt="" src="images/CreateBox1.png" height="165" width="810"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from 1st 'Create Box' action.</i></p>

<p><img alt="" src="images/CreateBox2.png" height="185" width="810"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from 2nd 'Create Box' action.</i></p>

<p><img alt="" src="images/CreateBox3.png" height="205" width="810"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from 3rd 'Create Box' action.</i></p>

<p><img alt="" src="images/CreateBox4.png" height="35" width="705"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from 4th 'Create Box' action.</i></p>

<p><img alt="" src="images/greenCircle.png"> 
3.1.3. For the 'Read Boxes' (method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/controller/BoxBean.java#L125">'BoxBean::readCentralBoxes'</a>
) report shows the 3 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/boxes/CentralBox.java">'CentralBox'</a> 
objects and their dependencies.
</p>

<p><img alt="" src="images/ReadBoxes.png" height="665" width="810"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from 'Read Boxes' action.</i></p>

<p><img alt="" src="images/greenCircle.png"> 
3.1.4. For the 'Update & Read Boxes' (method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/controller/BoxBean.java#L152">'BoxBean::updateCentralBoxes'</a>
) the 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/boxes/CentralBox.java">'CentralBox'</a> 
field 'cardinalDirection' was changed.
</p>

<p><img alt="" src="images/UpdateAndReadBoxes.png" height="670" width="810"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from 'Update &amp; Read Boxes' action.</i></p>

<p><img alt="" src="images/greenCircle.png"> 
3.1.5. For the 'Delete Box' (method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/controller/BoxBean.java#L192">'BoxBean::deleteCentralBox'</a>
) the 4th call failed because there were no more 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/boxes/CentralBox.java">'CentralBox'</a> 
objects left after three 'Delete Box' calls.
</p>

<p><img alt="" src="images/DeleteBox1.png" height="35" width="627"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from 1st 'Delete Boxes' action.</i></p>

<p><img alt="" src="images/DeleteBox2.png" height="35" width="627"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from 2nd 'Delete Boxes' action.</i></p>

<p><img alt="" src="images/DeleteBox3.png" height="36" width="627"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from 3rd 'Delete Boxes' action.</i></p>

<p><img alt="" src="images/DeleteBox4.png" height="60" width="627"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from 4th 'Delete Boxes' action.</i></p>

<a href="#top">Back to the top of the page</a>
<h3 id="j_p_a_units"><img alt="" src="images/greenCircle.png"> 
3.2. JPA Example 'Units'</h3>

<p>Action:<br>
<img alt="" src="images/orangeHR-500.png"><br>
<img alt="" src="images/orangeSquare.png"> 1. Push the button 'Create-Read-Delete Units' the first time.<br>
<img alt="" src="images/orangeSquare.png"> 2. Push the button 'Create-Read-Delete Units' the second time.<br>
<img alt="" src="images/orangeHR-500.png"></p>

<p><img alt="" src="images/greenCircle.png"> 
3.2.1. For read actions there were used criteria queries (created with 'CriteriaBuilder').<br>

<p>The units entity classes have relationships:</p>
<ul>
<li><i>One-To-One</i> self-referential relationship between 'previous' and 'next' 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/units/Unit.java">'Unit'</a> objects</li>
<li><i>Many-To-One</i> self-referential relationship between 'parent' and 'child' 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/units/Unit.java">'Unit'</a> objects</li>
<li><i>One-To-Many</i> relationship between 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/units/Unit.java">'Unit'</a> 
object and 4 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/units/Side.java">'Side'</a> 
objects using enumeration 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/components/CardinalDirection.java">
CardinalDirection</a></li>
</ul>

<p><img alt="" src="images/DiagramUnits.png" height="200" width="600"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>The units relationships diagram.</i></p>

<p><img alt="" src="images/greenCircle.png"> 
3.2.2. With the first 'Create-Read-Delete Units' action the 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/units/Unit.java">'Unit'</a> 
objects were created and persisted to the database. It executed the method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/controller/UnitManagedBean.java#L98">
'UnitManagedBean::createUnits'</a>.
</p>

<p><img alt="" src="images/CreateReadDeleteUnits1.png" height="105" width="282"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from 1st 'Create-Read-Delete Units' action</i></p>

<p><img alt="" src="images/greenCircle.png"> 
3.2.3. With the second 'Create-Read-Delete Units' action the 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/units/Unit.java">'Unit'</a> 
objects were read from the database, presented as a report, and removed from the database.<br>
It executed the method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/controller/UnitManagedBean.java#L125">
'UnitManagedBean::readAndDeleteUnits'</a>.
</p>
<p>The presented report shows the results of the query.</p>
<ul>
<li>for 3 <a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/units/Unit.java">'Unit'</a> 
objects there is a <i>previous - next</i> relationship: A -> B -> C.</li>
<li>for 4 <a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/units/Unit.java">'Unit'</a> 
objects there is a <i>parent - child</i> relationship: C -> (X, Y, Z).</li>
<li>for all 6 <a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/units/Unit.java">'Unit'</a> 
objects and 24 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/units/Side.java">'Side'</a> 
objects there is a <i>one-to-many</i> relationship:<br>
every 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/units/Unit.java">'Unit'</a> 
object has four unique 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/units/Side.java">'Side'</a> objects.</li>
</ul>

<p><img alt="" src="images/CreateReadDeleteUnits2.png" height="242" width="776"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from 2nd 'Create-Read-Delete Units' action</i></p>

<a href="#top">Back to the top of the page</a>
<h3 id="j_p_a_levels"><img alt="" src="images/greenCircle.png"> 
3.3. JPA Example 'Levels'</h3>

<p>Actions:<br>
<img alt="" src="images/orangeHR-500.png"><br>
<img alt="" src="images/orangeSquare.png"> 1. Push the button 'Create-Read-Delete Levels' the first time.<br>
<img alt="" src="images/orangeSquare.png"> 2. Push the button 'Create-Read-Delete Levels' the second time.<br>
<img alt="" src="images/orangeHR-500.png"></p>

<p><img alt="" src="images/greenCircle.png"> 
3.3.1. For CRUD actions there were used criteria queries (created with 'CriteriaBuilder') with metamodels in package 
<a href="https://github.com/k1729p/Study13/tree/main/ejb/src/main/java/kp/j_p_a/domain/levels">'levels'</a>.
</p>
<p>
The entity classes for levels:
</p>
<ul>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/levels/Level.java">'Level'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/levels/FirstLevel.java">'FirstLevel'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/levels/SecondLevel.java">'SecondLevel'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/levels/ThirdLevel.java">'ThirdLevel'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/levels/FourthLevel.java">'FourthLevel'</a></li>
</ul>

<p><img alt="" src="images/DiagramLevels.png" height="350" width="200"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>The levels relationships diagram. It is the 'One-To-Many' hierarchical relationships.</i>
</p>
<p><img alt="" src="images/greenCircle.png">
3.3.2. With the first 'Create-Read-Delete Levels' action the 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/levels/Level.java">'Level'</a> 
objects were created and persisted to the database. It executed the method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/controller/LevelManagedBean.java#L117">
'LevelManagedBean::createLevels'</a>.
</p>

<p><img alt="" src="images/CreateReadDeleteLevels1.png" height="57" width="107"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from 1st 'Create-Read-Delete Levels' action</i></p>

<p><img alt="" src="images/greenCircle.png"> 
3.3.3. With the second 'Create-Read-Delete Levels' action the 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/domain/levels/Level.java">'Level'</a> 
objects were read from the database, presented as a report, and removed from the database.<br>
The four methods were executed in a sequence:
</p>
<ol>
<li>the read method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/controller/LevelManagedBean.java#L150">
'LevelManagedBean::readWithQueryUsingJoins'</a></li>
<li>the read method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/controller/LevelManagedBean.java#L177">
'LevelManagedBean::readWithCriteriaUsingJoins'</a></li>
<li>the read method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/controller/LevelManagedBean.java#L274">
'LevelManagedBean::readWithCriteriaUsingAggregateFunctions'</a></li>
<li>the delete method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_p_a/controller/LevelManagedBean.java#L320">
'LevelManagedBean::deleteLevels'</a></li>
</ol>

<p>The presented report shows the results of the four queries:
</p>
<ol>
<li>the query using string with pattern "<b>SELECT ... FROM ... JOIN ... WHERE ... IN ...</b>"</li>
<li>the query using string with pattern "<b>SELECT ... FROM ... IN   ... WHERE ... IN ...</b>"</li>
<li>the query using criteria with '<b>join</b>'</li>
<li>the aggregate function query using criteria with '<b>groupBy</b>'</li>
</ol>
<p>For the 1st, 2nd, and 3rd queries, the result is identical.<br>
The result of the 4th query is the intersection of the '<b>having</b>' restriction and the '<b>where</b>' restriction.
</p>

<p><img alt="" src="images/CreateReadDeleteLevels2.png" height="703" width="938"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from 2nd 'Create-Read-Delete Levels' action</i></p>

<a href="#top">Back to the top of the page</a>
<hr>
<h2 id="j_m_s">❹ Java Message Service</h2>
<p>
The initial JMS configuration in the WildFly server was done with the batch file 
<a href="https://github.com/k1729p/Study13/blob/main/0_batch/04%20CLI%20Config%20Queue%20%26%20Topic.bat">'04 CLI Config Queue & Topic.bat'</a>.<br>
The changed batch script was used for creating the topics.
</p>

<p>Initial actions:<br>
<img alt="" src="images/orangeHR-500.png"><br>
<img alt="" src="images/orangeSquare.png"> 1. Go to page <a href="http://localhost:8080/Study13/">http://localhost:8080/Study13/</a>
	and select "Java Message Service".<br>
<img alt="" src="images/orangeHR-500.png"></p>

<p><img alt="" src="images/j_m_s_Controls.png" width="1200" /><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from "Java Message Service" page controls.</i></p>

<p>
The JSF page  on the screenshot 
<a href="https://github.com/k1729p/Study13/blob/main/web/src/main/webapp/j_m_s.xhtml">'j_m_s.xhtml'</a> uses the beans:
</p>
<table style="border:solid"><tbody><tr>
<td style="border:solid"><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_m_s/sync/queue/QueueProducerSync.java">
'QueueProducerSync'</a></td>
<td style="border:solid"><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_m_s/sync/queue/QueueConsumerSync.java">
'QueueConsumerSync'</a></td>
</tr><tr>
<td style="border:solid"><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_m_s/sync/topic/TopicProducerSync.java">
'TopicProducerSync'</a></td>
<td style="border:solid"><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_m_s/sync/topic/TopicConsumerSync.java">
'TopicConsumerSync'</a></td>
</tr><tr>
<td style="border:solid"><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_m_s/async/queue/QueueProducerAsync.java">
'QueueProducerAsync'</a></td>
<td style="border:solid"></td>
</tr><tr>
<td style="border:solid"><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_m_s/async/topic/TopicProducerAsync.java">
'TopicProducerAsync'</a></td>
<td style="border:solid"></td>
</tr></tbody></table>

<br>

<p><img alt="" src="images/DiagramQueuesAndTopics.png" height="800" width="1100"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Queues &amp; topics diagram.</i></p>

<a href="#top">Back to the top of the page</a>
<h3 id="j_m_s_sync"><img alt="" src="images/greenCircle.png"> 
4.1. JMS Example 'Synchronous Queue &amp; Topic'</h3>

<p>Actions:<br>
<img alt="" src="images/orangeHR-500.png"><br>
<img alt="" src="images/orangeSquare.png"> 1. Using the link 'Open Page in New Browser Tab' open the second browser tab.<br>
<img alt="" src="images/orangeSquare.png"> 2. In the <b>2nd tab</b> push the button "Queue Receive (Sync)".<br>
<img alt="" src="images/orangeSquare.png"> 3. In the <b>1st tab</b> push the button "Queue Send (Sync)".<br>
<img alt="" src="images/orangeSquare.png"> 4. In the <b>2nd tab</b> push the button "Topic Receive (Sync)".<br>
<img alt="" src="images/orangeSquare.png"> 5. In the <b>1st tab</b> push the button "Topic Send (Sync)".<br>
<img alt="" src="images/orangeSquare.png"> 6. In the <b>1st tab</b> click the link "Reload Report".<br>
<img alt="" src="images/orangeHR-500.png"></p>

<p><img alt="" src="images/greenCircle.png"> 
4.1.1. The synchronous queue methods
</p>
<ol>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_m_s/sync/queue/QueueProducerSync.java#L39">
'QueueProducerSync::sendQueueMessages'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_m_s/sync/queue/QueueConsumerSync.java#L39">
'QueueConsumerSync::receiveQueueMessages'</a></li>
</ol>

<p><img alt="" src="images/greenCircle.png"> 
4.1.2. The synchronous topic methods
</p>
<ol>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_m_s/sync/topic/TopicProducerSync.java#L39">
'TopicProducerSync::sendTopicMessages'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_m_s/sync/topic/TopicConsumerSync.java#L39">
'TopicConsumerSync::receiveTopicMessages'</a></li>
</ol>

<p><img alt="" src="images/greenCircle.png"> 
4.1.3. The methods used on reply queue:
<ul>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_m_s/reply/ReplyHelper.java#L40">
'ReplyHelper::processControlMessage'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_m_s/reply/ReplyQueueMDB.java#L42">
'ReplyQueueMDB::onMessage'</a></li>
</ul>

<p><img alt="" src="images/SynchronousQueueAndTopicSendReceive.png" height="472" width="374"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from synchronous queue &amp; topic send/receive actions.</i></p>

<a href="#top">Back to the top of the page</a>
<h3 id="j_m_s_async"><img alt="" src="images/greenCircle.png"> 
4.2. JMS Example 'Asynchronous Queue &amp; Topic'</h3>

<p>Action:<br>
<img alt="" src="images/orangeHR-500.png"><br>
<img alt="" src="images/orangeSquare.png"> 1. Push the button "Queue Send (Async)".<br>
<img alt="" src="images/orangeSquare.png"> 2. Push the button "Topic Send (Async)".<br>
<img alt="" src="images/orangeSquare.png"> 3. Click the link "Reload Report".<br>
<img alt="" src="images/orangeHR-500.png"></p>

<p><img alt="" src="images/greenCircle.png"> 
4.2.1. The asynchronous queue methods:
</p>
<ol>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_m_s/async/queue/QueueProducerAsync.java#L39">
'QueueProducerAsync::sendQueueMessages'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_m_s/async/queue/QueueConsumerMDB.java#L37">
'QueueConsumerMDB::onMessage'</a></li>
</ol>

<p><img alt="" src="images/greenCircle.png"> 
4.2.2. The asynchronous topic methods:
</p>
<ol>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_m_s/async/topic/TopicProducerAsync.java#L39">
'TopicProducerAsync::sendTopicMessages'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_m_s/async/topic/TopicConsumerMDB.java#L37">
'TopicConsumerMDB::onMessage'</a></li>
</ol>

<p><img alt="" src="images/greenCircle.png"> 
4.2.3. The methods used on reply queue:
</p>
<ul>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_m_s/reply/ReplyHelper.java#L40">
'ReplyHelper::processControlMessage'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/j_m_s/reply/ReplyQueueMDB.java#L42">
'ReplyQueueMDB::onMessage'</a></li>
</ul>

<p><img alt="" src="images/AsynchronousQueueAndTopicSendReceive.png" height="440" width="375"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from asynchronous queue &amp; topic send/receive actions.</i></p>

<a href="#top">Back to the top of the page</a>
<h3 id="j_m_s_other_scenarios"><img alt="" src="images/greenCircle.png"> 
4.3. Other JMS test scenarios</h3>

<p><img alt="" src="images/greenCircle.png"> 
4.3.1. "First send then receive" test scenario for synchronous queue:
</p>
<ol>
	<li>Send to queue.</li>
	<li>Restart server.</li>
	<li>Receive from the queue.</li>
	<li>Result: messages were <b>not lost</b>.</li>
</ol>
<p><img alt="" src="images/greenCircle.png">
4.3.2. "First send then receive" test scenario for synchronous topic:
</p>
<ol>
	<li>Send to the topic.</li>
	<li>Receive from the topic.</li>
	<li>Because the receiver waits for messages (page hangs), repeat the sending to the topic.</li>
	<li>Result: messages sent in the 1st action were <b>lost</b>.</li>
</ol>
<p><img alt="" src="images/greenCircle.png">
4.3.3. "Two consumers" test scenario for synchronous queue:
</p>
<ol>
	<li>Open the 2nd & the 3rd tab.</li>
	<li>In the 2nd tab push the button "Queue Receive (Sync)".</li>
	<li>In the 3rd tab push the button "Queue Receive (Sync)".</li>
	<li>In the 1st tab push the button "Queue Send (Sync)" <b>two times</b> and click the link "Reload Report".</li>
	<li>Result: for two consumers two queues were used because this is point-to-point messaging.</li>
</ol>
<p><img alt="" src="images/greenCircle.png">
4.3.4. "Two subscribers" test scenario for synchronous topic:
</p>
<ol>
	<li>open the 2nd & the 3rd tab.</li>
	<li>In the 2nd tab push the button "Topic Receive (Sync)".</li>
	<li>In the 3rd tab push the button "Topic Receive (Sync)".</li>
	<li>In the 1st tab push the button "Queue Send (Sync)" <b>one time</b> and click link "Reload Report".</li>
	<li>Result: for two subscribers single topic was used because this is the 'publish/subscribe' messaging.</li>
</ol>

<a href="#top">Back to the top of the page</a>
<hr>
<h2 id="trans_c_m_t">❺ Container-Managed Transactions</h2>

<p>
The queues initializer for the message-driven beans 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/queues/ParcelQueuesInitializer.java">
'ParcelQueuesInitializer'</a> creates the queues:
</p>
<ul>
<li>CreateParcelQueue</li>
<li>ConfirmCreateParcelQueue</li>
<li>ReadParcelQueue</li>
</ul>

<p>Action:<br>
<img alt="" src="images/orangeHR-500.png"><br>
<img alt="" src="images/orangeSquare.png"> 1. Go to page <a href="http://localhost:8080/Study13/">http://localhost:8080/Study13/</a>
	and select "Container-Managed Transactions".<br>
<img alt="" src="images/orangeSquare.png"> 2. Push the button "Send to 'CreateParcelQueue'" three times and the button "Reload Report".<br>
<img alt="" src="images/orangeSquare.png"> 3. Push the button "Send to 'ReadParcelQueue'" and the button "Reload Report".<br>
<img alt="" src="images/orangeSquare.png"> 4. Push the button "Show Audit" and the button "Reload Report".<br>
<img alt="" src="images/orangeHR-500.png"></p>

<p><img alt="" src="images/transactions_c_m_t_Controls.png" width="1200" /><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from "Container-Managed Transactions" page controls.</i></p>

<p>
The JSF page on the screenshot 
<a href="https://github.com/k1729p/Study13/blob/main/web/src/main/webapp/transactions_c_m_t.xhtml">'transactions_c_m_t.xhtml'</a> uses the bean
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/controller/TransCmtManagedBean.java">
'TransCmtManagedBean'</a>
</p>

<p><img alt="" src="images/greenCircle.png"> 
5.1. The <a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/domain/Parcel.java">'Parcel'</a> 
objects are created with the method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/service/ParcelAdministratorBean.java#L58">
'ParcelAdministratorBean::create'</a> 
and read with the method
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/service/ParcelAdministratorBean.java#L74">
'ParcelAdministratorBean::read'</a>. 
The auditing is done with the methods 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/service/AuditorBean.java#L49">
'AuditorBean::recordCreated'</a> and 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/service/AuditorBean.java#L61">
'AuditorBean::recordApproved'</a>.
</p>
<p>
The <a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/domain/Parcel.java">'Parcel'</a> 
approving logic in method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/helper/Approver.java#L49">'Approver::approve'</a>:
</p>
<ul>
<li>Every newly created 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/domain/Parcel.java">'Parcel'</a> 
object is validated.</li>
<li>The <a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/domain/Parcel.java">'Parcel'</a> 
with an odd id value (1, 3, 5, ...) is not approved and the transaction is marked for rollback.</li>
<li>The <a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/domain/Parcel.java">'Parcel'</a> 
with even id value (2, 4, 6, ...) is approved.</li>
</ul>
<p><img alt="" src="images/DiagramResearchCMT.png" height="1398" width="1200"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>The CMT sequence diagram.</i></p>

<p><img alt="" src="images/greenCircle.png"> 
5.2. For these three repeated actions "Send to 'CreateParcelQueue'" (method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/controller/TransCmtManagedBean.java#L72">
'TransCmtManagedBean::create'</a>'):
</p>

<ol>
<li>The message from the 'CreateParcelQueue' is consumed and a new 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/domain/Parcel.java">'Parcel'</a> 
is created.</li>
<li>The confirmation message is sent to the 'ConfirmCreateParcelQueue'.</li>
<li>The created 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/domain/Parcel.java">'Parcel'</a> 
has an odd id value and is not approved.</li>
<li>Therefore, the transaction is marked for rollback.</li>
<li>The message is <b>redelivered</b> to the 'CreateParcelQueue' and from this message a new 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/domain/Parcel.java">'Parcel'</a> 
is created.</li>
<li>The confirmation message is sent to the 'ConfirmCreateParcelQueue'.</li>
<li>The created 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/domain/Parcel.java">'Parcel'</a> 
has an even id value and is approved.</li>
<li>From the 'ConfirmCreateParcelQueue' is consumed only the 2nd confirmation message.</li>
</ol>

<p><img alt="" src="images/CreateParcel1.png" height="196" width="575"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from 1st "Send to 'CreateParcelQueue'" action</i></p>

<p><img alt="" src="images/CreateParcel2.png" height="197" width="575"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from 2nd "Send to 'CreateParcelQueue'" action</i></p>

<p><img alt="" src="images/CreateParcel3.png" height="196" width="575"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from 3rd "Send to 'CreateParcelQueue'" action</i></p>

<p><img alt="" src="images/greenCircle.png"> 
5.3. The results of the action "Send to 'ReadParcelQueue'" (method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/controller/TransCmtManagedBean.java#L94">
'TransCmtManagedBean::read'</a>) show that all committed 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/domain/Parcel.java">'Parcel'</a> 
objects in the database have even id values. This proves that all not approved 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/domain/Parcel.java">'Parcel'</a> 
objects were rolled back.</p>

<p><img alt="" src="images/ReadParcels.png" height="106" width="575"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from "Send to 'ReadParcelQueue'" action</i>.</p>

<p><img alt="" src="images/greenCircle.png"> 
5.4. The auditing in the action "Show Audit" (method 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_c_m_t/controller/TransCmtManagedBean.java#L107">
'TransCmtManagedBean::showAudit'</a>) is always processed in a new transaction. 
Therefore the audit information was not lost when the main transaction was rolled back.</p>

<p><img alt="" src="images/ShowAudit.png" height="34" width="575"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from "Show Audit" action</i></p>

<a href="#top">Back to the top of the page</a>
<hr>
<h2 id="trans_b_m_t">❻ Bean-Managed Transactions</h2>

<table style="border:solid"><tbody><tr><td style="border:solid"><i>
In a stateless session bean with bean-managed transactions,<br>
a business method must commit or roll back a transaction before returning.<br>
However, a stateful session bean does not have this restriction.<br>
In a stateful session bean with a JTA transaction,<br>
the association between the bean instance and the transaction is retained across multiple client calls.<br>
Even if each business method called by the client opens and closes the database connection,<br>
the association is retained until the instance completes the transaction.
</i></td></tr></tbody></table>

<p>Action:<br>
<img alt="" src="images/orangeHR-500.png"><br>
<img alt="" src="images/orangeSquare.png"> 1. Go to the page <a href="http://localhost:8080/Study13/">http://localhost:8080/Study13/</a>
	and select "Bean-Managed Transactions".<br>
<img alt="" src="images/orangeSquare.png"> 2. Push the button "Create Capsule" two times.<br>
<img alt="" src="images/orangeSquare.png"> 3. Push the button "Commit Transaction" and the button "Read Capsule".<br>
<img alt="" src="images/orangeSquare.png"> 4. Push the button "Create Capsule" and the button "Read Capsule".<br>
<img alt="" src="images/orangeSquare.png"><img alt="" src="images/spacer-32.png">
This step has created a not committed 'Capsule' object.<br>
<img alt="" src="images/orangeSquare.png"> 5. Push the button "Rollback Transaction" and the button "Read Capsule".<br>
<img alt="" src="images/orangeSquare.png"><img alt="" src="images/spacer-32.png">
It was rolled back to the last commit (point 3. above).<br>
<img alt="" src="images/orangeSquare.png"> 6. Push the button "Delete Capsule" and the button "Read Capsule".<br>
<img alt="" src="images/orangeSquare.png"><img alt="" src="images/spacer-32.png">
The "Delete Capsule" action deletes the last created 'Capsule'<br>
<img alt="" src="images/orangeSquare.png"> 7. Push the button "Rollback Transaction" and the button "Read Capsule".<br>
<img alt="" src="images/orangeSquare.png"><img alt="" src="images/spacer-32.png">
Again, it was rolled back to the last commit (point 3. above).<br>
<img alt="" src="images/orangeHR-500.png"></p>

<p><img alt="" src="images/transactions_b_m_t_Controls.png" width="1200" /><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from "Bean-Managed Transactions" page controls.</i></p>

<p>
The JSF page on the screenshot 
<a href="https://github.com/k1729p/Study13/blob/main/web/src/main/webapp/transactions_b_m_t.xhtml">'transactions_b_m_t.xhtml'</a> uses the bean
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_b_m_t/controller/TransBmtManagedBean.java">
'TransBmtManagedBean'</a>
</p>

<p><img alt="" src="images/greenCircle.png"> 
6.1. The methods of the <b>stateful</b> session bean 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_b_m_t/service/CapsuleAdministratorBean.java">
'CapsuleAdministratorBean'</a>:
</p>
<ul>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_b_m_t/service/CapsuleAdministratorBean.java#L79">
'CapsuleAdministratorBean::create'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_b_m_t/service/CapsuleAdministratorBean.java#L106">
'CapsuleAdministratorBean::read'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_b_m_t/service/CapsuleAdministratorBean.java#L137">
'CapsuleAdministratorBean::delete'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_b_m_t/service/CapsuleAdministratorBean.java#L176">
'CapsuleAdministratorBean::commit'</a></li>
<li><a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_b_m_t/service/CapsuleAdministratorBean.java#L197">
'CapsuleAdministratorBean::rollback'</a></li>
</ul>

<p><img alt="" src="images/DiagramResearchBMT.png" height="237" width="708"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>BMT class diagram.</i></p>

<p><img alt="" src="images/greenCircle.png"> 
6.2. Creating the 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_b_m_t/domain/Capsule.java">'Capsule'</a> 
object and committing the transaction.
<p>

<p><img alt="" src="images/CreateAndCommitCapsule.png" height="128" width="570"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from  actions: 1st "Create Capsule", 2nd "Create Capsule", "Commit Transaction", "Read Capsule"</i></p>

<p><img alt="" src="images/greenCircle.png"> 
6.3. Creating the 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_b_m_t/domain/Capsule.java">'Capsule'</a> 
object and rollbacking the transaction.
<p>

<p><img alt="" src="images/CreateCapsule.png" height="105" width="570"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from  actions: 3rd "Create Capsule", "Read Capsule"</i></p>

<p><img alt="" src="images/RollbackCreatedCapsule.png" height="82" width="570"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from  actions: 1st "Rollback Transaction", "Read Capsule"</i></p>

<p><img alt="" src="images/greenCircle.png"> 
6.4. Deleting the 
<a href="https://github.com/k1729p/Study13/blob/main/ejb/src/main/java/kp/trans_b_m_t/domain/Capsule.java">'Capsule'</a> 
object and rollbacking the transaction.
<p>

<p><img alt="" src="images/DeleteCapsule.png" height="59" width="570"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from  actions: "Delete Capsule", "Read Capsule"</i></p>

<p><img alt="" src="images/RollbackDeletedCapsule.png" height="83" width="570"/><br>
<img alt="" src="images/blackArrowUp.png">
<i>Screenshot from  actions: 2nd "Rollback Transaction", "Read Capsule"</i></p>

<a href="#top">Back to the top of the page</a>
<hr>
</body>
</html>
